{"id":"behavior-818bd38de0c2","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Always follow TDD workflow: RED (write failing test first) → GREEN (implement minimal fix to pass) → REFACTOR (clean up implementation, requires review). Never skip the failing test step - it validates the test actually catches the problem. Refactor phase is for cleaning up code quality, not adding features.","expanded":"When working on this type of task, avoid: Implementing features or fixes without writing a failing test first, or skipping the refactor phase\n\nInstead: Always follow TDD workflow: RED (write failing test first) → GREEN (implement minimal fix to pass) → REFACTOR (clean up implementation, requires review). Never skip the failing test step - it validates the test actually catches the problem. Refactor phase is for cleaning up code quality, not adding features.","structured":{"avoid":"Implementing features or fixes without writing a failing test first, or skipping the refactor phase","prefer":"Always follow TDD workflow: RED (write failing test first) → GREEN (implement minimal fix to pass) → REFACTOR (clean up implementation, requires review). Never skip the failing test step - it validates the test actually catches the problem. Refactor phase is for cleaning up code quality, not adding features."}},"kind":"constraint","name":"learned/always-follow-tdd-workflow-red-write-failing-tes","overrides":null,"provenance":{"source_type":"learned","created_at":"2026-02-01T11:31:03.81231673-08:00","correction_id":"correction-1769974263"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"times_activated":0,"times_followed":0,"times_overridden":0,"created_at":"2026-02-01T11:31:03.812328001-08:00","updated_at":"2026-02-01T11:31:03.812328071-08:00"}}}
{"id":"behavior-c5bf127ed6aa","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"For bug fixes, always follow TDD: (1) write a failing test that reproduces the bug, (2) fix the bug, (3) verify the test passes. This ensures the bug is understood, the fix works, and prevents regressions.","expanded":"When working on this type of task, avoid: Fixed bugs directly without first writing tests to reproduce them\n\nInstead: For bug fixes, always follow TDD: (1) write a failing test that reproduces the bug, (2) fix the bug, (3) verify the test passes. This ensures the bug is understood, the fix works, and prevents regressions.","structured":{"avoid":"Fixed bugs directly without first writing tests to reproduce them","prefer":"For bug fixes, always follow TDD: (1) write a failing test that reproduces the bug, (2) fix the bug, (3) verify the test passes. This ensures the bug is understood, the fix works, and prevents regressions."}},"kind":"directive","name":"learned/for-bug-fixes-always-follow-tdd-1-write-a-fail","overrides":null,"provenance":{"correction_id":"correction-1769818509","created_at":"2026-01-30T16:15:09.919337743-08:00","source_type":"learned"},"requires":null,"when":{}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-30T16:15:09.919364773-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-30T16:15:09.919364904-08:00"}}}
{"id":"behavior-3de9531527a2","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Always run `go test ./internal/ui/dashboard/... -run TestRenderDebug -v` before and after UI changes to validate the dashboard layout visually. This test renders the dashboard at multiple sizes (120x35, 100x30, 80x24) and is safe to run locally as it only renders strings without filesystem operations.","expanded":"When working on this type of task, avoid: Making UI changes without visual validation using the render debug test\n\nInstead: Always run `go test ./internal/ui/dashboard/... -run TestRenderDebug -v` before and after UI changes to validate the dashboard layout visually. This test renders the dashboard at multiple sizes (120x35, 100x30, 80x24) and is safe to run locally as it only renders strings without filesystem operations.","structured":{"avoid":"Making UI changes without visual validation using the render debug test","prefer":"Always run `go test ./internal/ui/dashboard/... -run TestRenderDebug -v` before and after UI changes to validate the dashboard layout visually. This test renders the dashboard at multiple sizes (120x35, 100x30, 80x24) and is safe to run locally as it only renders strings without filesystem operations."}},"kind":"directive","name":"learned/always-run-`go-test-internal-ui-dashboard-r","overrides":null,"provenance":{"approved_at":"2026-01-31T17:14:20.616857036-08:00","approved_by":"auto","correction_id":"correction-1769908460","created_at":"2026-01-31T17:14:20.616505336-08:00","source_type":"learned"},"requires":null,"when":{"file_path":"ui/*","task":"development"}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"created_at":"2026-01-31T17:14:20.616532126-08:00","times_activated":0,"times_followed":0,"times_overridden":0,"updated_at":"2026-01-31T17:14:20.616532196-08:00"}}}
{"id":"behavior-7ca8e86d15b4","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Use unit tests (call model.Update(msg) directly) for testing custom message handling. Reserve teatest for key-based interactions only (navigation, text assertions). The three-tier testing strategy: Unit tests → Message handling, Teatest → Key inputs, VHS → Visual regression","expanded":"When working on this type of task, avoid: Using teatest tm.Send() for custom Bubble Tea messages like OnboardingCompleteMsg - these tests fail because teatest routes messages through a channel that doesn't match Bubble Tea's internal message loop\n\nInstead: Use unit tests (call model.Update(msg) directly) for testing custom message handling. Reserve teatest for key-based interactions only (navigation, text assertions). The three-tier testing strategy: Unit tests → Message handling, Teatest → Key inputs, VHS → Visual regression","structured":{"avoid":"Using teatest tm.Send() for custom Bubble Tea messages like OnboardingCompleteMsg - these tests fail because teatest routes messages through a channel that doesn't match Bubble Tea's internal message loop","prefer":"Use unit tests (call model.Update(msg) directly) for testing custom message handling. Reserve teatest for key-based interactions only (navigation, text assertions). The three-tier testing strategy: Unit tests → Message handling, Teatest → Key inputs, VHS → Visual regression"}},"kind":"preference","name":"learned/use-unit-tests-call-model-updatemsg-directly-f","overrides":null,"provenance":{"source_type":"learned","created_at":"2026-02-01T11:30:16.350064975-08:00","correction_id":"correction-1769974216"},"requires":null,"when":{"file_path":"test/*","task":"testing"}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"times_activated":0,"times_followed":0,"times_overridden":0,"created_at":"2026-02-01T11:30:16.350090903-08:00","updated_at":"2026-02-01T11:30:16.350090973-08:00"}}}
{"id":"behavior-ccf3b37f5d9f","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"For TUI testing in go4dot, follow the three-tier approach: 1) Unit tests in internal/ui/dashboard/*_test.go for message handling (fast, reliable), 2) Teatest e2e in test/e2e/scenarios/ for key inputs only, 3) VHS tapes in test/e2e/tapes/ for visual regression with screenshot verification","expanded":"When working on this type of task, avoid: Writing e2e tests that require custom messages to be sent to the TUI model, expecting teatest to handle them like Bubble Tea would\n\nInstead: For TUI testing in go4dot, follow the three-tier approach: 1) Unit tests in internal/ui/dashboard/*_test.go for message handling (fast, reliable), 2) Teatest e2e in test/e2e/scenarios/ for key inputs only, 3) VHS tapes in test/e2e/tapes/ for visual regression with screenshot verification","structured":{"avoid":"Writing e2e tests that require custom messages to be sent to the TUI model, expecting teatest to handle them like Bubble Tea would","prefer":"For TUI testing in go4dot, follow the three-tier approach: 1) Unit tests in internal/ui/dashboard/*_test.go for message handling (fast, reliable), 2) Teatest e2e in test/e2e/scenarios/ for key inputs only, 3) VHS tapes in test/e2e/tapes/ for visual regression with screenshot verification"}},"kind":"directive","name":"learned/for-tui-testing-in-go4dot-follow-the-three-tier-a","overrides":null,"provenance":{"source_type":"learned","created_at":"2026-02-01T11:30:19.024445217-08:00","correction_id":"correction-1769974219"},"requires":null,"when":{"task":"development"}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"times_activated":0,"times_followed":0,"times_overridden":0,"created_at":"2026-02-01T11:30:19.024461127-08:00","updated_at":"2026-02-01T11:30:19.024461197-08:00"}}}
{"id":"behavior-ff39a3bf2217","kind":"behavior","content":{"conflicts":null,"content":{"canonical":"Use VHS tapes for visual regression testing. After making visual TUI changes: 1) Run make e2e-visual to generate screenshots, 2) Use multimodal capabilities to verify test/e2e/screenshots/*.png look correct, 3) If good, commit. TDD workflow: RED (failing test) → GREEN (implement) → REFACTOR (clean up + VHS visual verify)","expanded":"When working on this type of task, avoid: Not using VHS for visual verification when making TUI changes\n\nInstead: Use VHS tapes for visual regression testing. After making visual TUI changes: 1) Run make e2e-visual to generate screenshots, 2) Use multimodal capabilities to verify test/e2e/screenshots/*.png look correct, 3) If good, commit. TDD workflow: RED (failing test) → GREEN (implement) → REFACTOR (clean up + VHS visual verify)","structured":{"avoid":"Not using VHS for visual verification when making TUI changes","prefer":"Use VHS tapes for visual regression testing. After making visual TUI changes: 1) Run make e2e-visual to generate screenshots, 2) Use multimodal capabilities to verify test/e2e/screenshots/*.png look correct, 3) If good, commit. TDD workflow: RED (failing test) → GREEN (implement) → REFACTOR (clean up + VHS visual verify)"}},"kind":"procedure","name":"learned/use-vhs-tapes-for-visual-regression-testing-after","overrides":null,"provenance":{"source_type":"learned","created_at":"2026-02-01T11:30:21.06722085-08:00","correction_id":"correction-1769974221"},"requires":null,"when":{"task":"development"}},"metadata":{"confidence":0.6,"priority":0,"scope":"both","stats":{"times_activated":0,"times_followed":0,"times_overridden":0,"created_at":"2026-02-01T11:30:21.067243222-08:00","updated_at":"2026-02-01T11:30:21.067243342-08:00"}}}
